# NVIDIA API 使用规则速查表

**来源**: https://github.com/XKD001/My_moltbot/blob/main/api-usage-limits.md
**创建时间**: 2026-02-07
**最后更新**: 2026-02-07

## ⚡ 速率限制（Rate Limiting）

### 基于时间的限制
- **RPS（每秒请求数）**: 免费账户 1-10 次/秒
- **RPM（每分钟请求数）**: 60-600 次/分钟
- **RPH（每小时请求数）**: 根据账户类型和地区而异

### 不同API差异
- 简单查询类API: RPM可达600+
- 复杂推理类API: RPM只有60-100
- 批量处理API: 按任务数而非请求数限制

### 超限处理
- **HTTP 429 Too Many Requests**: 表示请求过多
- **应对策略**: 指数退避（1s, 2s, 4s, 8s...）

## 🔀 并发限制

### 免费账户限制
| 限制类型 | 免费账户 |
|---------|---------|
| 单个API端点并发 | 1-5个 |
| 总并发请求数 | 5-20个 |
| 活跃会话数 | 1-3个 |

### 应对策略
- ✅ 使用信号量（Semaphore）控制并发数
- ✅ 实现请求队列，按顺序处理
- ✅ 使用异步编程提高效率
- ❌ 避免在短时间内发送大量并发请求

## 📊 配额管理

### 免费账户常见配额
- **每日请求配额**: 1,000 - 10,000 次/天
- **每月请求配额**: 10,000 - 100,000 次/月
- **单次输入大小**: ≤10MB
- **单次输出大小**: ≤50MB

### 配额查询方法
- **Dashboard查看**: 访问 NVIDIA Developer Dashboard
- **API响应头**: X-RateLimit-Limit, X-RateLimit-Remaining
- **状态API**: GET /api/v1/quota/status

## 🎯 实用检查清单

### 使用API前检查
- [ ] 检查当前配额剩余量
- [ ] 确认账户状态正常
- [ ] 验证API密钥有效性
- [ ] 准备重试机制
- [ ] 设置监控告警

### 编写代码时
- [ ] 实现指数退避重试逻辑
- [ ] 使用信号量控制并发
- [ ] 添加请求超时设置
- [ ] 记录详细的错误日志
- [ ] 设置配额使用告警

### 运行时监控
- [ ] 实时跟踪配额消耗
- [ ] 监控并发请求数
- [ ] 记录API响应时间
- [ ] 检测异常使用模式
- [ ] 定期生成使用报告

## 🚫 超出限制的应对策略

| 限制类型 | 超出时的症状 | 首选解决方案 |
|---------|-------------|-------------|
| 速率限制 | HTTP 429 + "Rate limit exceeded" | 实施退避等待 |
| 配额限制 | HTTP 429 + "Quota exceeded" | 等待配额刷新 |
| 并发限制 | 连接超时或请求堆积 | 减少并发数 |
| 大小限制 | HTTP 400 + "Payload too large" | 拆分请求 |

## ✅ 最佳实践

### 建议做法
- ✅ 始终实现重试机制，包括退避策略
- ✅ 在非高峰期执行批量任务
- ✅ 预留足够的配额余量（20-30%）
- ✅ 定期检查和优化API使用

### 避免做法
- ❌ 短时间内发送大量并发请求
- ❌ 忽略HTTP 429错误
- ❌ 在生产环境使用接近限制的配额
- ❌ 将API密钥硬编码在代码中

## 🔗 官方资源

- **NVIDIA 开发者主页**: https://developer.nvidia.com/
- **NIM API 文档**: https://build.nvidia.com/docs
- **NGC 文档**: https://docs.nvidia.com/ngc/
- **状态页面**: 查看服务状态和公告

## 💡 关键规则速记

1. **RPS限制**: 1-10次/秒（免费账户）
2. **RPM限制**: 60-600次/分钟
3. **并发限制**: 最多5-20个请求
4. **每日配额**: 1,000-10,000次
5. **退避策略**: 指数退避（1s, 2s, 4s, 8s...）
6. **配额保留**: 预留20-30%余量
7. **监控告警**: 低于20%剩余时提醒

---

**记忆时间**: 2026-02-08 20:34 GMT+8
**状态**: ✅ 已学习并保存规则
**下次更新**: 当NVIDIA官方政策变化时
